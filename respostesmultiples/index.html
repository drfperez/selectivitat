<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Selectivitat: Tecnologia i Enginyeria</title>
<style>
:root {
    --bg-color: #f4f7fa;
    --text-color: #111;
    --card-color: #fff;
    --btn-color: #e7e9ec;
    --btn-hover: #d0d4e0;
    --accent-color: #0059b3;
    --correct-color: #4CAF50;
    --wrong-color: #E53935;
}

body.dark {
    --bg-color: #0f1114;
    --text-color: #eaeaea;
    --card-color: #1c1f23;
    --btn-color: #2a2e33;
    --btn-hover: #3b4148;
    --accent-color: #7ab8ff;
    --correct-color: #3fa44a;
    --wrong-color: #cc4a4a;
}

body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    transition: background 0.4s ease, color 0.4s ease;
}

header {
    background: var(--accent-color);
    color: white;
    padding: 20px;
    text-align: center;
    position: relative;
}

.mode-toggle {
    position: absolute;
    top: 15px;
    right: 20px;
    cursor: pointer;
    font-size: 1.6em;
    user-select: none;
}

.question-card {
    background: var(--card-color);
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.12);
    border: 1px solid rgba(0,0,0,0.06);
}

.answers button {
    display: block;
    margin: 7px 0;
    padding: 12px;
    width: 100%;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: var(--btn-color);
    color: var(--text-color);
    font-size: 1em;
    transition: background 0.25s, transform 0.1s;
}

.answers button:hover {
    background: var(--btn-hover);
    transform: scale(1.02);
}

.correct { background: var(--correct-color) !important; color: white !important; }
.wrong { background: var(--wrong-color) !important; color: white !important; }

.progress-container {
    background: #bbb;
    border-radius: 10px;
    overflow: hidden;
    height: 20px;
    margin-bottom: 20px;
}

.progress-bar {
    background: var(--accent-color);
    height: 100%;
    width: 0%;
    transition: width 0.3s ease;
}

#restart-btn {
    padding: 12px 24px;
    background: var(--accent-color);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 20px;
    font-size: 1.1em;
    transition: background 0.25s;
}

#restart-btn:hover {
    background: #0072e0;
}

footer {
    text-align: center;
    padding: 15px;
    font-size: 0.9em;
    color: var(--text-color);
    opacity: 0.7;
}

</style>
</head>
<body>

<header>
    <h1>Selectivitat: Tecnologia i Enginyeria</h1>
    <span class="mode-toggle" onclick="toggleMode()">🌞</span>
</header>

<main id="quiz">
    <div id="timer">Temps: 10:00</div>
    <div id="score">Puntuació: 0/0</div>
    <div class="progress-container">
        <div class="progress-bar" id="progress"></div>
    </div>
    <p>Carregant preguntes...</p>
</main>

<footer>
    &copy; 2025 Nom Alumne
</footer>

<script>
let darkMode = false;
let score = 0;
let answered = 0;
let totalQuestions = 0;
let timerInterval;
let timeLeft = 600; // 10 minuts

function toggleMode() {
    darkMode = !darkMode;
    document.body.classList.toggle('dark', darkMode);
    document.querySelector('.mode-toggle').textContent = darkMode ? '🌙' : '🌞';
}

function startTimer() {
    updateTimerDisplay();
    timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        if(timeLeft <= 0) {
            clearInterval(timerInterval);
            finishQuiz();
        }
    }, 1000);
}

function updateTimerDisplay() {
    const minutes = Math.floor(timeLeft / 60).toString().padStart(2,'0');
    const seconds = (timeLeft % 60).toString().padStart(2,'0');
    document.getElementById('timer').textContent = `Temps: ${minutes}:${seconds}`;
}

function finishQuiz() {
    const quiz = document.getElementById('quiz');
    const percent = Math.round((score/totalQuestions)*100);
    let message = '';
    if(percent >= 90) message = 'Sobresalient! Excel·lent treball!';
    else if(percent >= 70) message = 'Notable! Bona feina!';
    else if(percent >= 50) message = 'Aprovat! Tens marge de millora.';
    else message = 'Suspès. Necessites més repàs.';

    quiz.innerHTML = `<p>Puntuació final: ${score}/${totalQuestions} (${percent}%)</p>
                      <div id="final-message">${message}</div>
                      <button id="restart-btn" onclick="restartQuiz()">Tornar a començar</button>`;
}

function restartQuiz() {
    score = 0;
    answered = 0;
    timeLeft = 600;
    loadQuestions();
}

async function loadQuestions() {
    clearInterval(timerInterval);
    const response = await fetch('preguntes.json');
    const data = await response.json();
    totalQuestions = data.length;
    score = 0;
    answered = 0;
    const quiz = document.getElementById('quiz');
    quiz.innerHTML = `
        <div id="timer">Temps: 10:00</div>
        <div id="score">Puntuació: 0/${totalQuestions}</div>
        <div class="progress-container">
            <div class="progress-bar" id="progress"></div>
        </div>
    `;
    startTimer();

    data.forEach((q, index) => {
        const card = document.createElement('div');
        card.className = 'question-card';
        card.innerHTML = `<p><strong>${index+1}. ${q.pregunta}</strong></p><div class="answers"></div><div class="feedback"></div>`;
        const ansDiv = card.querySelector('.answers');
        const feedbackDiv = card.querySelector('.feedback');

        q.respostes.forEach(r => {
            const btn = document.createElement('button');
            btn.textContent = r.text;
            btn.onclick = () => {
                if(btn.disabled) return;
                if(r.correcta) {
                    btn.classList.add('correct');
                    score++;
                } else {
                    btn.classList.add('wrong');
                }
                feedbackDiv.textContent = r.feedback;
                Array.from(ansDiv.children).forEach(b => b.disabled = true);
                answered++;
                document.getElementById('score').textContent = `Puntuació: ${score}/${totalQuestions}`;
                document.getElementById('progress').style.width = `${(answered/totalQuestions)*100}%`;
                if(answered === totalQuestions) {
                    clearInterval(timerInterval);
                    finishQuiz();
                }
            };
            ansDiv.appendChild(btn);
        });

        quiz.appendChild(card);
    });
}

loadQuestions();
</script>

</body>
</html>
